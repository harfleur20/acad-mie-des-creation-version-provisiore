<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Détails Formation - Académie des créatifs</title>
    <base href="./" />
    <link rel="icon" href="Assets/logo_ico_hd.png" type="image/png" />
    <link rel="stylesheet" href="details-style.css" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>

  <body>
    <div id="header-placeholder"></div>

    <main>
      <section class="hero-section">
        <div class="container">
          <div class="hero-content">
            <div class="back-btn">
              <a
                href="#"
                onclick="if(document.referrer) { history.back(); } else { window.location.href='index.html'; } return false;"
              >
                <i class="fa-solid fa-arrow-left"></i> Retour
              </a>
            </div>

            <h1 id="detail-titre">Chargement...</h1>
            <p id="detail-description">...</p>

            <div class="video-preview">
              <img id="detail-image" src="" alt="Aperçu" />
            </div>
          </div>

          <div class="hero-sidebar">
            <h3>Les détails de la formation</h3>
            <ul id="detail-points"></ul>

            <div id="detail-compteur" class="countdown-card"></div>

            <div class="price-slider">
              <h3>Prix de la formation</h3>
              <div class="price">
                <span id="detail-prix-actuel" class="price-1">--</span>
                <span id="detail-prix-barre" class="original-price">--</span>
              </div>
            </div>

            <!-- BOUTON D'ACHAT -->
            <button
              id="detail-btn-paiement"
              class="cta-button cta-button-payment"
              style="opacity: 0.7; cursor: wait; background-color: #bdc3c7"
            >
              <i class="fa-solid fa-circle-notch fa-spin"></i> Chargement...
            </button>

            <div class="share-container">
                <p>Partager cette formation :</p>
                <div class="share-buttons">
                    <a href="#" id="share-facebook" class="share-btn fb" target="_blank" title="Partager sur Facebook">
                        <i class="fa-brands fa-facebook-f"></i>
                    </a>
                    
                    <a href="#" id="share-whatsapp" class="share-btn wa" target="_blank" title="Partager sur WhatsApp">
                        <i class="fa-brands fa-whatsapp"></i>
                    </a>

                    <button id="share-copy" class="share-btn cp" title="Copier le lien">
                        <i class="fa-solid fa-link"></i>
                    </button>
                    
                    <button id="share-native" class="share-btn native" style="display:none;" title="Plus d'options">
                        <i class="fa-solid fa-share-nodes"></i>
                    </button>
                </div>
            </div>

            <!-- MESSAGE DE STATUT (AJOUTÉ) -->
            <div
              id="purchase-status-message"
              style="
                display: none;
                margin-top: 10px;
                padding: 10px;
                border-radius: 5px;
                font-size: 0.9rem;
                background: #d1ecf1;
                color: #0c5460;
                border: 1px solid #bee5eb;
              "
            ></div>
          </div>
        </div>
        <div class="rating-box">
          <span>Note de la formation :</span>
          <div class="stars-voter" id="stars-container">
            <i class="fa-solid fa-star" data-value="1"></i>
            <i class="fa-solid fa-star" data-value="2"></i>
            <i class="fa-solid fa-star" data-value="3"></i>
            <i class="fa-solid fa-star" data-value="4"></i>
            <i class="fa-solid fa-star" data-value="5"></i>
          </div>
          <span id="vote-count" style="font-size: 0.8rem; color: #666"
            >(0 avis)</span
          >
        </div>
      </section>

      <section class="capabilities-section">
        <div class="container">
          <h2>À la fin de ce cours, vous serez capable de...</h2>
          <ul id="detail-objectifs"></ul>
        </div>
      </section>

      <section class="learning-section">
        <div class="container">
          <h2>Quelques TP qui vous attendent.</h2>
          <div id="detail-tp" class="container-img"></div>
        </div>
      </section>

      <section class="target-audience-section">
        <div class="container">
          <h2>À qui s'adresse ce cours ?</h2>
          <p id="detail-audience"></p>
        </div>
      </section>

      <div id="lightbox-modal" class="lightbox">
            <span class="close-lightbox">&times;</span>
            
            <a class="lightbox-prev" onclick="changeSlide(-1)">&#10094;</a>

            <div class="lightbox-content-wrapper">
                <img id="lightbox-img" src="" alt="Aperçu">
                <video id="lightbox-video" controls style="display:none;"></video>
            </div>

            <a class="lightbox-next" onclick="changeSlide(1)">&#10095;</a>
        </div>

      <section class="certificate-section">
        <div class="container">
          <div class="certificate-content">
            <h2>Certificat d'achèvement</h2>
            <p>
              À la fin du cours, après avoir complété tous les modules et
              projets, vous recevrez un certificat d'achèvement que vous pourrez
              partager.
            </p>
          </div>
          <img
            src="Assets/certicate.jpg"
            alt="Certificat d'achèvement"
            class="certificate-image"
          />
        </div>
      </section>

      <section class="modules-section">
        <div class="container">
          <h2>Modules détaillés du cours</h2>
          <div id="detail-modules" class="accordion"></div>
        </div>
      </section>

      <section class="faq-section">
        <div class="container">
          <h2>Questions fréquentes</h2>
          <div id="detail-faq" class="accordion"></div>
        </div>
      </section>
    </main>
    <div id="footer-placeholder"></div>

    <!-- Scripts existants -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="global-loader.js"></script>
    <script src="script.js"></script>
    <script src="vote.js"></script>
    <script src="load-components.js"></script>
    <script src="detail-compteur.js"></script>
    <script src="animation-compteur.js"></script>
    <script src="compteur-presentiel.js"></script>

    <!-- Script pour charger le courseId dynamiquement -->
    <script>
      // Ce script récupère l'ID de la formation depuis l'URL
      document.addEventListener("DOMContentLoaded", function () {
        // Exemple d'URL : /formation-details.html?id=123
        const urlParams = new URLSearchParams(window.location.search);
        const courseId = urlParams.get("id");

        if (courseId) {
          // Stocke l'ID dans le bouton
          const purchaseBtn = document.getElementById("detail-btn-paiement");
          if (purchaseBtn) {
            purchaseBtn.dataset.courseId = courseId;
          }

          // Stocke aussi dans une variable globale pour les autres scripts
          window.currentCourseId = courseId;

          console.log("Course ID chargé:", courseId);
        }
      });
    </script>

    <script
      id="pixel-script-poptin"
      src="https://cdn.popt.in/pixel.js?id=e5988994f2063"
      async="true"
    ></script>

    <!-- Cookies banner -->
    <script>
      fetch("cookie-banner.html")
        .then((response) => {
          if (!response.ok) {
            throw new Error("Fichier cookie-banner.html introuvable.");
          }
          return response.text();
        })
        .then((html) => {
          document.body.insertAdjacentHTML("beforeend", html);
          initializeCookieBanner();
        })
        .catch((error) => {
          console.error(
            "Erreur lors du chargement du bandeau des cookies:",
            error
          );
        });
    </script>
  </body>
</html>
